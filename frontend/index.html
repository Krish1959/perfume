<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Perfume ‚Äî Local HTML + FastAPI</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="./perfume.css" />
</head>
<body>
  <main class="perfume-app">
    <!-- A: Title -->
    <div class="avatar-title">Perfume Sales Assistand: <span id="aname">‚Äî</span></div>

    <!-- B: Avatar stage -->
    <section class="avatar-stage">
      <!-- Static placeholder shown when avatar is not live -->
      <img id="avatarPlaceholder"
           src="https://files2.heygen.ai/avatar/v3/74447a27859a456c955e01f21ef18216_45620/preview_talk_1.webp"
           alt="Avatar preview" />
      <video id="avatarVideo" playsinline muted></video>
      <audio id="avatarAudio"></audio>
      <div id="audioGate" class="avatar-overlay">
        <button id="enableBtn" type="button">üîä Tap to enable sound</button>
      </div>
    </section>

    <!-- C: viewer status -->
    <div id="viewerStatus" class="status-bar">Initializing‚Ä¶</div>

    <!-- D/E/F: input + main controls -->
    <section class="controls-wrap">
      <textarea id="editBox" class="transcribe-box" placeholder="Message‚Ä¶">Hello, who are you?</textarea>

      <!-- All six buttons in one row -->
      <div class="controls-row" id="controlsRow">
        <button id="btn-mic" class="mic-button">üéôÔ∏è Rec</button>
        <button id="btn-send-avatar" title="Send to Avatar">üí¨ Avt</button>
        <button id="btn-instruction"  title="Instruction">Ins</button>
        <button id="btn-chatgpt"      title="Send to ChatGPT">GPT</button>
        <button id="btn-start"        title="Start Session">‚ñ∂ SS</button>
        <button id="btn-stop"         title="End Session">‚èπ ES</button>
      </div>
    </section>

    <!-- K: tiles -->
    <h3 style="margin:24px 4px 10px">Perfume Collection</h3>
    <!-- One single row with horizontal scroll -->
    <section id="perfumeGrid" class="perfume-gallery one-row">
      <figure class="perfume-item" data-say="Endless mountains & rivers.">
        <img src="./assets/1_Endless_rivers.png" alt="Endless Mountains & Rivers" />
        <figcaption>Endless Mountains & Rivers</figcaption>
      </figure>

      <figure class="perfume-item" data-say="Flowing gently into calm.">
        <img src="./assets/2_Flowing_Calm.png" alt="Flowing Gently Into Calm" />
        <figcaption>Flowing Gently Into Calm</figcaption>
      </figure>

      <figure class="perfume-item" data-say="Stillness in the mountains. Quiet strength.">
        <img src="./assets/3_Still_Mountain.png" alt="Stillness in the Mountains" />
        <figcaption>Stillness in the Mountains</figcaption>
      </figure>

      <figure class="perfume-item" data-say="Wind through wooden frames.">
        <img src="./assets/4_Wind_Frames.png" alt="Wind Through Wooden Frames" />
        <figcaption>Wind Through Wooden Frames</figcaption>
      </figure>

      <figure class="perfume-item" data-say="Rain in the hills.">
        <img src="./assets/5_Rain_Hills.png" alt="Rain in the Hills" />
        <figcaption>Rain in the Hills</figcaption>
      </figure>
    </section>

    <!-- Debug console (unchanged) -->
    <h3 style="margin:26px 4px 10px">Debug Console</h3>
    <textarea id="uiDebug" class="transcribe-box" style="min-height:130px" readonly></textarea>
  </main>

  <!-- Fixed avatar/voice/pose (still overridable by backend env) -->
  <script>
    window.HEYGEN_FIXED = {
      avatar_id: "June_HR_public",
      voice_id:  "68dedac41a9f46a6a4271a95c733823c",
      pose_name: "June HR"
    };
  </script>

  <script src="./perfume.js"></script>
  <script>
    // Power-on: start the same routine as the Start Session button
    window.addEventListener("load", () => {
      if (typeof window.__startSession === "function") {
        window.__startSession();
      }
    });
  </script>
</body>
</html>
